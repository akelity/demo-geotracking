const admin = require('firebase-admin');
const serviceAccountSecretKey = require("./serviceAccountKey.json");

var adminApp = admin.initializeApp({
    credential: admin.credential.cert(serviceAccountSecretKey),
    databaseURL: "https://geotrackingdemo-585d6-default-rtdb.europe-west1.firebasedatabase.app"
});

const botRef = adminApp.database().ref('users/BotTestPath');

const path = [
    [ 9.1695073, 45.4780002 ],
    [ 9.1684774, 45.4769771 ],
    [ 9.1683486, 45.4760743 ],
    [ 9.1685632, 45.475322 ],
    [ 9.1690782, 45.4746298 ],
    [ 9.1698078, 45.4740581 ],
    [ 9.1706231, 45.4735465 ],
    [ 9.1713098, 45.4731553 ],
    [ 9.1719106, 45.4726737 ],
    [ 9.1722539, 45.4721621 ],
    [ 9.1728547, 45.4717408 ],
    [ 9.1735843, 45.4712894 ],
    [ 9.174228, 45.4708681 ],
    [ 9.1747001, 45.4704166 ],
    [ 9.1751722, 45.4700254 ],
    [ 9.1756442, 45.4697244 ],
    [ 9.1760734, 45.4693633 ],
    [ 9.1763738, 45.468972 ],
    [ 9.1769746, 45.4687012 ],
    [ 9.1774038, 45.46834 ],
    [ 9.1783908, 45.4680089 ],
    [ 9.1791204, 45.4677381 ],
    [ 9.1804937, 45.467708 ],
    [ 9.1818241, 45.4681895 ],
    [ 9.1828111, 45.468972 ],
    [ 9.1833261, 45.470206 ],
    [ 9.1827682, 45.4712894 ],
    [ 9.1818241, 45.4721621 ],
    [ 9.1810945, 45.472764 ],
    [ 9.1809228, 45.4735465 ],
    [ 9.1815666, 45.474359 ],
    [ 9.1815236, 45.4753822 ],
    [ 9.1813949, 45.4765859 ],
    [ 9.1811374, 45.4777294 ],
    [ 9.1805795, 45.4775789 ],
    [ 9.1802362, 45.4774585 ],
    [ 9.1796354, 45.4774585 ],
    [ 9.1791204, 45.4774285 ],
    [ 9.1785625, 45.4773081 ],
    [ 9.1780904, 45.4772479 ],
    [ 9.1776613, 45.4770674 ],
    [ 9.1773179, 45.4769169 ],
    [ 9.1768888, 45.4768266 ],
    [ 9.1765455, 45.476616 ],
    [ 9.1760734, 45.4768266 ],
    [ 9.1755584, 45.4771275 ],
    [ 9.1750005, 45.4774886 ],
    [ 9.1743568, 45.4779701 ],
    [ 9.173756, 45.4782108 ],
    [ 9.1731981, 45.4784215 ],
    [ 9.1725973, 45.478602 ],
    [ 9.1720823, 45.4787525 ],
    [ 9.1716102, 45.4787525 ],
    [ 9.1709236, 45.4788127 ],
    [ 9.1704086, 45.478602 ]
];
let index = 0;

setInterval(function() {
    updatePosition(path[index]);
    if (++index > path.length-1) index = 0;
}, 1000);

const updatePosition = (coords) => {
    botRef.set({
        lat: coords[1],
        lng: coords[0],
        uid: "BotTestPath"
    }).then(() => { console.log("Geolocation saved!") });
}
